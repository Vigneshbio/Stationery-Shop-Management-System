<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css">
  <style>
    .cart-item-img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      margin-right: 15px;
    }
  </style>
</head>
<body>
<div class="container my-5">
  <h1 class="mb-4">Checkout</h1>

  <ul id="cart-summary" class="list-group mb-3">
    {% for item in cart_items %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center">
          <img src="{{ url_for('static', filename=item.image_url) }}" alt="{{ item.product_name }}" class="cart-item-img">
          <span>{{ item.product_name }} (x{{ item.quantity }})</span>
        </div>
        <span>₹{{ item.price * item.quantity }}</span>
      </li>
    {% endfor %}
  </ul>

  <h4 id="cart-total">Total: ₹{{ total }}</h4>

  <h4 class="mt-4">Customer Details</h4>
  <form action="/payment-success" method="POST">
    <div class="form-group">
      <label for="name">Full Name</label>
      <input type="text" class="form-control" id="name" name="name" required>
    </div>
    <div class="form-group">
      <label for="email">Email Address</label>
      <input type="email" class="form-control" id="email" name="email" required>
    </div>
    <div class="form-group">
      <label for="phone">Phone Number</label>
      <input type="tel" class="form-control" id="phone" name="phone" required>
    </div>
    <div class="form-group">
      <label for="address">Shipping Address</label>
      <textarea class="form-control" id="address" name="address" rows="3" required></textarea>
    </div>

    <h4 class="mt-4">Payment Method</h4>

<div class="form-check">
  <input class="form-check-input" type="radio" name="payment_method" id="gpay" value="gpay" required>
  <label class="form-check-label" for="gpay">GPay / UPI</label>
</div>

<div class="form-check">
  <input class="form-check-input" type="radio" name="payment_method" id="cod" value="cod">
  <label class="form-check-label" for="cod">Cash on Delivery</label>
</div>

<div class="form-check">
  <input class="form-check-input" type="radio" name="payment_method" id="card" value="card">
  <label class="form-check-label" for="card">Credit/Debit Card</label>
</div>

<div id="card-details" class="mt-3" style="display:none;">
  <div class="form-group">
    <label for="card_number">Card Number</label>
    <input type="text" class="form-control" id="card_number" name="card_number" placeholder="1234 5678 9012 3456">
  </div>
  <div class="form-row">
    <div class="form-group col-md-6">
      <label for="expiry">Expiry Date</label>
      <input type="text" class="form-control" id="expiry" name="expiry" placeholder="MM/YY">
    </div>
    <div class="form-group col-md-6">
      <label for="cvv">CVV</label>
      <input type="password" class="form-control" id="cvv" name="cvv" placeholder="123">
    </div>
  </div>
</div>
    <button type="submit" class="btn btn-success mt-4">Confirm & Pay</button>
  </form>
</div>
<script>
  const cardRadio = document.getElementById('card');
  const gpayRadio = document.getElementById('gpay');
  const codRadio = document.getElementById('cod');
  const cardDetails = document.getElementById('card-details');

  function toggleCardFields() {
    if (cardRadio.checked) {
      cardDetails.style.display = 'block';
      document.getElementById('card_number').required = true;
      document.getElementById('expiry').required = true;
      document.getElementById('cvv').required = true;
    } else {
      cardDetails.style.display = 'none';
      document.getElementById('card_number').required = false;
      document.getElementById('expiry').required = false;
      document.getElementById('cvv').required = false;
    }
  }

  cardRadio.addEventListener('change', toggleCardFields);
  gpayRadio.addEventListener('change', toggleCardFields);
  codRadio.addEventListener('change', toggleCardFields);
</script>

</body>
</html>
